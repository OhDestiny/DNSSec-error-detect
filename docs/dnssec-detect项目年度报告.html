<!DOCTYPE html><html><head>
      <title>项目</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:///c:\Users\OhDestiny\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.8.11\crossnote\dependencies\katex\katex.min.css">
      
      
      
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<h1 id="dnssec-detect项目年度报告">dnssec-detect项目年度报告 </h1>
<hr>
<ul>
<li>
<p>illuminate</p>
</li>
<li>
<p>iwbtfy</p>
</li>
</ul>
<hr>
<h2 id="1项目背景与要求">1.项目背景与要求 </h2>
<h3 id="11-梳理错误类型">1.1 梳理错误类型 </h3>
<table>
<thead>
<tr>
<th>INFO-CODE</th>
<th style="text-align:center">PURPOSE</th>
<th style="text-align:center">DESCRIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td style="text-align:center">other error</td>
<td style="text-align:center">does not match known extended error</td>
</tr>
<tr>
<td>1</td>
<td style="text-align:center">Unsupported DNSKEY Algorithm</td>
<td style="text-align:center">DNSKEY RRset contained only unsupported DNSSEC algorithms.</td>
</tr>
<tr>
<td>2</td>
<td style="text-align:center">Unsupported DS Digest Type</td>
<td style="text-align:center">a DS RRset contained only unsupported Digest Types.</td>
</tr>
<tr>
<td>3</td>
<td style="text-align:center">stale Answer</td>
<td style="text-align:center">The resolver was unable to resolve the answer within its time limits</td>
</tr>
<tr>
<td>4</td>
<td style="text-align:center">Forged Answer</td>
<td style="text-align:center">provide a forged answer for some reasons</td>
</tr>
<tr>
<td>5</td>
<td style="text-align:center">DNSSEC Indeterminate</td>
<td style="text-align:center">DNSSEC validation by resolver ended in the indeterminate state</td>
</tr>
<tr>
<td>6</td>
<td style="text-align:center">DNSSEC Bogus</td>
<td style="text-align:center">DNSSEC validation by resolver ended in the bogus state</td>
</tr>
<tr>
<td>7</td>
<td style="text-align:center">Signature Expired</td>
<td style="text-align:center">no signatures are presently valid and some (often all) are expired</td>
</tr>
<tr>
<td>8</td>
<td style="text-align:center">Signature Not Yet Valid</td>
<td style="text-align:center">no signatures are presently valid and at least some are not yet valid.</td>
</tr>
<tr>
<td>9</td>
<td style="text-align:center">DNSKEY Missing</td>
<td style="text-align:center">A DS record existed at a parent, but no supported matching DNSKEY record could be found for the child</td>
</tr>
<tr>
<td>10</td>
<td style="text-align:center">RRSIGs Missing</td>
<td style="text-align:center">no RRSIGs could be found for at least one RRset where RRSIGs were expected.</td>
</tr>
<tr>
<td>11</td>
<td style="text-align:center">No Zone Key Bit Set</td>
<td style="text-align:center">no Zone Key Bit was set in a DNSKEY</td>
</tr>
<tr>
<td>12</td>
<td style="text-align:center">NSEC Missing</td>
<td style="text-align:center">the requested data was missing and a covering NSEC or NSEC3 was not provided.</td>
</tr>
<tr>
<td>13</td>
<td style="text-align:center">Cached Error</td>
<td style="text-align:center">The resolver is returning the SERVFAIL RCODE from its cache.</td>
</tr>
<tr>
<td>14</td>
<td style="text-align:center">Not Ready</td>
<td style="text-align:center">The server is unable to answer the query, as it was not fully functional when the query was received.</td>
</tr>
<tr>
<td>15</td>
<td style="text-align:center">Blocked</td>
<td style="text-align:center">The server is unable to respond to the request because the domain is on a blocklist</td>
</tr>
<tr>
<td>16</td>
<td style="text-align:center">Censored</td>
<td style="text-align:center">The server is unable to respond to the request because the domain is on a blocklist due to an external requirement imposed by an entity</td>
</tr>
<tr>
<td>17</td>
<td style="text-align:center">Filtered</td>
<td style="text-align:center">the request domain is on a blocklist as requested by the client</td>
</tr>
<tr>
<td>18</td>
<td style="text-align:center">Prohibited</td>
<td style="text-align:center">a query from an "unauthorized" client can annotate its REFUSED message with this code</td>
</tr>
<tr>
<td>19</td>
<td style="text-align:center">Stale NXDomain Answer</td>
<td style="text-align:center">answer with a previously cached NXDOMAIN answer</td>
</tr>
<tr>
<td>20</td>
<td style="text-align:center">Not Authoritative</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td>21</td>
<td style="text-align:center">Not Supported</td>
<td style="text-align:center">The requested operation or query is not supported</td>
</tr>
<tr>
<td>22</td>
<td style="text-align:center">No Reachable Authority</td>
<td style="text-align:center">The resolver could not reach any of the authoritative name servers (or they potentially refused to reply).</td>
</tr>
<tr>
<td>23</td>
<td style="text-align:center">Network Error</td>
<td style="text-align:center">An unrecoverable error occurred while communicating with another server.</td>
</tr>
<tr>
<td>24</td>
<td style="text-align:center">Invalid Data</td>
<td style="text-align:center">The authoritative server cannot answer with data for a zone it is otherwise configured to support</td>
</tr>
<tr>
<td>25-49151</td>
<td style="text-align:center">Unassigned</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td>49151-65535</td>
<td style="text-align:center">reserved for private use</td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<h3 id="12-配置梳理的错误并且验证服务器是否可以检测错误">1.2 配置梳理的错误并且验证服务器是否可以检测错误 </h3>
<ul>
<li>在梳理完错误的基础上，拟搭建测试环境，将多个支持DNSSEC的权威域名设置不同错误配置，通过命令行和脚本的形式发数据包请求，对开放的支持DNSSEC的重要递归解析服务器进行探测，<br>
分析递归解析服务器是否提供相应的错误提示，以判定递归服务器对DNSSEC配置错误是否有效验证。</li>
</ul>
<h2 id="2项目方案">2.项目方案 </h2>
<p><strong>首先</strong>，我们基于 RFC8914 等标准，全面梳理DNSSEC的错误配置类型；<br>
<strong>接着</strong>，我们搭建了域名iwbtfy.top，配置好了可以配置的相关错误；<br>
<strong>同时</strong>，为了配置更多的错误，我们扩展到三级域，并且进行相应的配置；<br>
<strong>然后</strong>，我们从全球前百万的dns服务器表中筛选了支持dnssec的递归服务器；<br>
<strong>最后</strong>，编写好python脚本探测程序，以及python结果统计程序，对这一错误进行检错统计。大致方案流程如下图：<br>
<img src="../resources/photos/dnssec_configuration_framework.png" alt=""></p>
<h3 id="21-环境准备">2.1 环境准备 </h3>
<hr>
<ul>
<li>一台腾讯云服务器：123.207.59.193</li>
<li>一个腾讯云的域名：iwbtfy.top</li>
</ul>
<hr>
<h3 id="22-配置域名iwbtfytop">2.2 配置域名iwbtfy.top </h3>
<p><strong>1. 将租借的iwbtfy.top域名解析的dns服务器指向租借的腾讯云服务器</strong><br>
<img src="./photos/set_dns_server.png" alt=""><br>
<strong>2. 在腾讯云服务器中配置该域名的域配置文件，使其可以成功解析域名</strong></p>
<ul>
<li>下载安装bind<pre data-role="codeBlock" data-info="shell" class="language-shell shell"><code>yum <span class="token function">install</span> <span class="token builtin class-name">bind</span> <span class="token parameter variable">-y</span>
</code></pre></li>
<li>配置/etc/named.conf文件<pre data-role="codeBlock" data-info="c" class="language-c c"><code>zone <span class="token string">"iwbtfy.top"</span> IN <span class="token punctuation">{</span>
    type master<span class="token punctuation">;</span>
    <span class="token keyword keyword-auto">auto</span><span class="token operator">-</span>dnssec maintain<span class="token punctuation">;</span>
    update<span class="token operator">-</span>policy local<span class="token punctuation">;</span>
    file <span class="token string">"iwbtfy.top.zone"</span><span class="token punctuation">;</span>
    key<span class="token operator">-</span>directory <span class="token string">"/var/named/keys"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></li>
<li>配置/var/named/iwbtfy.top.zone文件<pre data-role="codeBlock" data-info="C" class="language-c C"><code>$TTL <span class="token number">600</span>
iwbtfy<span class="token punctuation">.</span>top<span class="token punctuation">.</span>	IN	SOA	ns	admin<span class="token punctuation">.</span>iwbtfy<span class="token punctuation">.</span>top<span class="token punctuation">.</span> <span class="token punctuation">(</span>
                <span class="token number">3</span>
                <span class="token number">1</span>H
                <span class="token number">5</span>M
                <span class="token number">2</span>D
                <span class="token number">6</span>H <span class="token punctuation">)</span>
iwbtfy<span class="token punctuation">.</span>top<span class="token punctuation">.</span>	IN	NS	ns<span class="token punctuation">.</span>iwbtfy<span class="token punctuation">.</span>top<span class="token punctuation">.</span>
iwbtfy<span class="token punctuation">.</span>top<span class="token punctuation">.</span>	IN	MX  <span class="token number">10</span>  mail<span class="token punctuation">.</span>iwbtfy<span class="token punctuation">.</span>top<span class="token punctuation">.</span>
ns		IN	A	<span class="token number">123.207</span><span class="token number">.59</span><span class="token number">.193</span>
mail		IN	A	<span class="token number">123.207</span><span class="token number">.59</span><span class="token number">.193</span>
<span class="token punctuation">;</span>www		IN	A	<span class="token number">123.207</span><span class="token number">.59</span><span class="token number">.193</span>
<span class="token punctuation">;</span>ftp		IN	CNAME	www
@               IN	A	<span class="token number">123.207</span><span class="token number">.59</span><span class="token number">.193</span>
www             IN      NS      ns1<span class="token punctuation">.</span>www
ns1<span class="token punctuation">.</span>www         IN      A       <span class="token number">123.207</span><span class="token number">.59</span><span class="token number">.193</span>
</code></pre></li>
</ul>
<p><strong>3. 在腾讯云服务器中进一步配置该域名的dnssec配置</strong></p>
<ul>
<li>
<p>生成keys</p>
<pre data-role="codeBlock" data-info="shell" class="language-shell shell"><code><span class="token function">mkdir</span>  /var/named/keys                       <span class="token comment"># 创建文件夹</span>
<span class="token builtin class-name">cd</span>  /var/named/keys
dnssec-keygen <span class="token parameter variable">-f</span> KSK <span class="token parameter variable">-a</span> RSASHA1 <span class="token parameter variable">-r</span> /dev/urandom <span class="token parameter variable">-b</span> <span class="token number">512</span> <span class="token parameter variable">-n</span> ZONE iwbtfy.top.
dnssec-keygen <span class="token parameter variable">-a</span> RSASHA1 <span class="token parameter variable">-r</span> /dev/urandom <span class="token parameter variable">-b</span> <span class="token number">512</span> <span class="token parameter variable">-n</span> ZONE iwbtfy.top.

kSK  Kiwbtfy.top.+005+16429.key
ZSK  Kiwbtfy.top.+005+63462.key
</code></pre></li>
<li>
<p>将keys添加到/var/named/iwbtfy.top.zone</p>
<pre data-role="codeBlock" data-info="shell" class="language-shell shell"><code><span class="token function">vi</span>  iwbtfy.top.zone 添加
<span class="token variable">$INCLUDE</span> <span class="token string">"/var/named/keys/Kiwbtfy.top.+005+16429.key"</span>
<span class="token variable">$INCLUDE</span> <span class="token string">"/var/named/keys/Kiwbtfy.top.+005+63462.key"</span> 
</code></pre></li>
<li>
<p>用keys签名zone</p>
<pre data-role="codeBlock" data-info="shell" class="language-shell shell"><code>dnssec-signzone <span class="token parameter variable">-K</span> /var/named/keys <span class="token parameter variable">-o</span> iwbtfy.top. /var/named/iwbtfy.top.zone
</code></pre></li>
<li>
<p>修改/etc/named.conf文件</p>
<pre data-role="codeBlock" data-info="shell" class="language-shell shell"><code> zone <span class="token string">"iwbtfy.top"</span> IN <span class="token punctuation">{</span>
    <span class="token builtin class-name">type</span> master<span class="token punctuation">;</span>
    auto-dnssec maintain<span class="token punctuation">;</span>
    update-policy <span class="token builtin class-name">local</span><span class="token punctuation">;</span>
    <span class="token function">file</span> <span class="token string">"iwbtfy.top.zone.signal"</span><span class="token punctuation">;</span>                  <span class="token comment"># 改成签名过的域文件</span>
    key-directory <span class="token string">"/var/named/keys"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span> 
</code></pre></li>
<li>
<p>生成ds记录</p>
<pre data-role="codeBlock" data-info="shell" class="language-shell shell"><code>dnssec-dsfromkey <span class="token parameter variable">-2</span> Kiwbtfy.top.+005+16429.key

iwbtfy.top. IN DS <span class="token number">16429</span> <span class="token number">5</span> <span class="token number">2</span> C86EDB0E66548551236FDF978CB92E12F005C033FA2B7DC21AA4FD98BF0E5E8B
</code></pre></li>
<li>
<p>将ds记录添加到腾讯云控制台<br>
<img src="./photos/set_ds1.png" alt=""></p>
</li>
</ul>
<h3 id="23-扩展三级域wwwiwbtfytop">2.3 扩展三级域——www.iwbtfy.top </h3>
<p><img src="./photos/three_domain.png" alt=""></p>
<h3 id="24-修改域名dnssec配置配置错误">2.4 修改域名dnssec配置——配置错误 </h3>
<p>具体修改------&gt; <a href="#3%E9%A1%B9%E7%9B%AE%E6%96%B9%E6%A1%88%E5%AE%9E%E6%96%BD%E7%BB%93%E6%9E%9C%E6%80%BB%E7%BB%93">3.项目方案实施结果总结</a></p>
<h3 id="25-筛选支持dnssec的递归服务器">2.5 筛选支持dnssec的递归服务器 </h3>
<ul>
<li><strong>收集dns服务器</strong>
<ul>
<li>网址：<a href="https://public-dns.info/">https://public-dns.info/</a></li>
</ul>
</li>
<li><strong>筛选支持dnssec的递归服务器</strong>
<ul>
<li>recursion</li>
</ul>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code><span class="token comment"># 筛选递归服务器</span>
<span class="token comment"># flag字段中含有RA ---&gt; recursion available</span>
<span class="token comment"># 参数说明</span>
<span class="token comment"># nameserver：需要检测的dns服务器ip</span>
<span class="token keyword keyword-def">def</span> <span class="token function">is_recursion</span><span class="token punctuation">(</span>nameserver<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token comment"># 定义dig命令和参数</span>
  dig_command <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'dig'</span><span class="token punctuation">,</span> <span class="token string">'+norecurse'</span><span class="token punctuation">,</span> <span class="token string">'example.com'</span><span class="token punctuation">,</span> <span class="token string">'@'</span> <span class="token operator">+</span> nameserver<span class="token punctuation">]</span>

  <span class="token comment"># 执行dig命令</span>
  <span class="token keyword keyword-try">try</span><span class="token punctuation">:</span>
      dig_output <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span>dig_command<span class="token punctuation">)</span>
  <span class="token keyword keyword-except">except</span> subprocess<span class="token punctuation">.</span>CalledProcessError <span class="token keyword keyword-as">as</span> e<span class="token punctuation">:</span>
      <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"Error running dig:"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>
      exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

  <span class="token comment"># 在输出中查找包含"flags"的行</span>
  flags_line <span class="token operator">=</span> <span class="token boolean">None</span>
  <span class="token keyword keyword-for">for</span> line <span class="token keyword keyword-in">in</span> dig_output<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token keyword keyword-if">if</span> <span class="token string">"flags"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword keyword-in">in</span> line<span class="token punctuation">:</span>
          flags_line <span class="token operator">=</span> line
          <span class="token keyword keyword-break">break</span>

  <span class="token comment"># 从含有flags的行中进一步查询是否有RA字段</span>
  <span class="token keyword keyword-if">if</span> <span class="token string">"ra"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword keyword-in">in</span> flags_line<span class="token punctuation">:</span>
      <span class="token keyword keyword-return">return</span> <span class="token boolean">True</span>
  <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span>
      <span class="token keyword keyword-return">return</span> <span class="token boolean">False</span>
</code></pre><ul>
<li>dnssec</li>
</ul>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code><span class="token comment"># 筛选递归服务器中的支持dnssec的递归服务器</span>
<span class="token comment"># flag字段中含有AD ---&gt; authenticated data</span>
<span class="token comment"># 参数说明</span>
<span class="token comment"># nameserver：需要检测的dns服务器ip</span>
<span class="token keyword keyword-def">def</span> <span class="token function">is_dnssec</span><span class="token punctuation">(</span>nameserver<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token comment"># 定义dig命令和参数</span>
  dig_command_two <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'dig'</span><span class="token punctuation">,</span> <span class="token string">'+norecurse'</span><span class="token punctuation">,</span> <span class="token string">'example.com'</span><span class="token punctuation">,</span> <span class="token string">'@'</span> <span class="token operator">+</span> nameserver<span class="token punctuation">]</span>

  <span class="token comment"># 执行dig命令</span>
  <span class="token keyword keyword-try">try</span><span class="token punctuation">:</span>
      dig_output <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span>dig_command_two<span class="token punctuation">)</span>
  <span class="token keyword keyword-except">except</span> subprocess<span class="token punctuation">.</span>CalledProcessError <span class="token keyword keyword-as">as</span> e<span class="token punctuation">:</span>
      <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"Error running dig:"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>
      exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

  <span class="token comment"># 在输出中查找包含"flags"的行</span>
  flags_line <span class="token operator">=</span> <span class="token boolean">None</span>
  <span class="token keyword keyword-for">for</span> line <span class="token keyword keyword-in">in</span> dig_output<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token keyword keyword-if">if</span> <span class="token string">"flags"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword keyword-in">in</span> line<span class="token punctuation">:</span>
          flags_line <span class="token operator">=</span> line
          <span class="token keyword keyword-break">break</span>

  <span class="token comment"># 从含有flags的行中进一步查询是否有RA字段</span>
  <span class="token keyword keyword-if">if</span> <span class="token string">"ad"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword keyword-in">in</span> flags_line<span class="token punctuation">:</span>
      <span class="token keyword keyword-return">return</span> <span class="token boolean">True</span>
  <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span>
      <span class="token keyword keyword-return">return</span> <span class="token boolean">False</span>
</code></pre></li>
</ul>
<h3 id="26-编写脚本探测服务器检错能力">2.6 编写脚本探测服务器检错能力 </h3>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code><span class="token comment"># 检测dnssec的配置错误并且写入文件</span>
<span class="token comment"># 参数说明</span>
<span class="token comment"># errors: 配置的错误(如果不知道可以填NULL)       domain_name: 需要检测的域名</span>
<span class="token comment"># nameserver_file: 使用的递归服务器的文件路径    key_file: 根服务器的key的路径</span>
<span class="token comment"># logs: 存储日志的列表                         record_types: 需要查询域名的记录类型</span>
<span class="token comment"># project_root_file: 项目的根路径</span>
<span class="token keyword keyword-def">def</span> <span class="token function">detect_error</span><span class="token punctuation">(</span>errors<span class="token punctuation">,</span> domain_names<span class="token punctuation">,</span> nameserver_file<span class="token punctuation">,</span> key_file<span class="token punctuation">,</span> logs<span class="token punctuation">,</span> record_types<span class="token punctuation">,</span> project_root_file<span class="token punctuation">)</span><span class="token punctuation">:</span>
    log_file <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>project_root_file<span class="token punctuation">,</span> <span class="token string">"data"</span><span class="token punctuation">,</span> <span class="token string">"detect_logs"</span><span class="token punctuation">,</span>
                            <span class="token string">"detect_logs_"</span> <span class="token operator">+</span> domain_names<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'_'</span> <span class="token operator">+</span>
                            errors <span class="token operator">+</span> <span class="token string">".txt"</span><span class="token punctuation">)</span>
    nameserver_re_dnssec <span class="token operator">=</span> np<span class="token punctuation">.</span>loadtxt<span class="token punctuation">(</span>nameserver_file<span class="token punctuation">,</span> delimiter<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">)</span>
    errors_set <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword keyword-for">for</span> nameserver <span class="token keyword keyword-in">in</span> nameserver_re_dnssec<span class="token punctuation">:</span>
        <span class="token comment"># 创建dig命令</span>
        dig_command <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'dig'</span><span class="token punctuation">,</span> <span class="token string">'@'</span> <span class="token operator">+</span> nameserver<span class="token punctuation">,</span> <span class="token string">'+sigchase'</span><span class="token punctuation">,</span> <span class="token string">'+trusted-key='</span> <span class="token operator">+</span> key_file<span class="token punctuation">,</span> domain_names<span class="token punctuation">,</span> record_types<span class="token punctuation">]</span>
        <span class="token keyword keyword-try">try</span><span class="token punctuation">:</span>
            <span class="token comment"># 日志</span>
            logs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>nameserver<span class="token punctuation">)</span>
            result <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span>dig_command<span class="token punctuation">)</span>
            lines <span class="token operator">=</span> result<span class="token punctuation">.</span>splitlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword keyword-if">if</span> lines<span class="token punctuation">:</span>
                last_line <span class="token operator">=</span> lines<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
                <span class="token keyword keyword-if">if</span> <span class="token keyword keyword-not">not</span> last_line<span class="token punctuation">:</span>
                    last_line <span class="token operator">=</span> lines<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span>
                <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span>last_line<span class="token punctuation">)</span>
                errors_set<span class="token punctuation">.</span>add<span class="token punctuation">(</span>last_line<span class="token punctuation">)</span>
            <span class="token comment"># 保存日志</span>
            logs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>result<span class="token punctuation">)</span>
        <span class="token keyword keyword-except">except</span> subprocess<span class="token punctuation">.</span>CalledProcessError <span class="token keyword keyword-as">as</span> e<span class="token punctuation">:</span>
            errors_set<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">"DIG command failed"</span><span class="token punctuation">)</span>
            logs<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"DIG command failed"</span><span class="token punctuation">)</span>
            <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"connection time out"</span><span class="token punctuation">)</span>
        <span class="token keyword keyword-except">except</span> FileNotFoundError<span class="token punctuation">:</span>
            <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">'DIG command not found. Make sure dig is installed on your system.'</span><span class="token punctuation">)</span>

    <span class="token comment"># 将log这个list写入txt文件</span>
    np<span class="token punctuation">.</span>savetxt<span class="token punctuation">(</span>log_file<span class="token punctuation">,</span> logs<span class="token punctuation">,</span> delimiter<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">,</span> fmt<span class="token operator">=</span><span class="token string">'%s'</span><span class="token punctuation">)</span>
    <span class="token comment"># 将error_set 写入txt文件</span>
    error_list <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>errors_set<span class="token punctuation">)</span>
    error_list_file <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>project_root_file<span class="token punctuation">,</span> <span class="token string">"data"</span><span class="token punctuation">,</span> <span class="token string">"error_list"</span><span class="token punctuation">,</span>
                                   <span class="token string">"errors_list_"</span> <span class="token operator">+</span> domain_names<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'_'</span> <span class="token operator">+</span>
                                   errors <span class="token operator">+</span> <span class="token string">".txt"</span><span class="token punctuation">)</span>
    np<span class="token punctuation">.</span>savetxt<span class="token punctuation">(</span>error_list_file<span class="token punctuation">,</span> error_list<span class="token punctuation">,</span> delimiter<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">,</span> fmt<span class="token operator">=</span><span class="token string">'%s'</span><span class="token punctuation">)</span>
</code></pre><h3 id="27-结果统计与分析">2.7 结果统计与分析 </h3>
<p>具体统计分析------&gt; <a href="#3%E9%A1%B9%E7%9B%AE%E6%96%B9%E6%A1%88%E5%AE%9E%E6%96%BD%E7%BB%93%E6%9E%9C%E6%80%BB%E7%BB%93">3.项目方案实施结果总结</a></p>
<h2 id="3项目方案实施结果总结">3.项目方案实施结果总结 </h2>
<h3 id="31-iwbtfytop上配置的错误">3.1 iwbtfy.top上配置的错误 </h3>
<ol>
<li><strong>错误的ds</strong></li>
</ol>
<ul>
<li>配置：修改ds记录的摘要算法<br>
<img src="./photos/modify_ds.png" alt=""></li>
<li>结果：<br>
<img src="../resources/photos/iwbtfy_ds_error_distribute.png" alt=""></li>
<li>说明：
<ul>
<li>Error no DS validates a DNSKEY in the DNSKEY RRset：期望的正确返回</li>
<li>DIGcommand failed：无法连接到dns服务器</li>
<li>Impossible to verify the non-existence, the NSEC RRset can’t be validated：服务器探测不到域名的A地址时的返回，即当服务器发现域名的DNSSEC配置有问题后就不再进一步解析，也可算是一种检错的结果</li>
<li>DSKEY is missing to Ncontinue validation：检测错误</li>
<li>RRSIG is missing to continue validation：检测错误</li>
<li>针对该配置错误类型，我们以Error no DS validates a DNSKEY in the DNSKEY Rrset为主要判断依据。</li>
</ul>
</li>
</ul>
<ol start="2">
<li><strong>Unsupported DNSKEY Algorithm</strong></li>
</ol>
<ul>
<li>配置：将DNSKEY的签名算法值改掉</li>
</ul>
<pre data-role="codeBlock" data-info="shell" class="language-shell shell"><code><span class="token number">600</span>	DNSKEY	<span class="token number">256</span> <span class="token number">3</span> <span class="token number">5</span> <span class="token punctuation">(</span>
        AwEAAdxgYRXnZANzpvCRkDg7chu82TfMMqHa
        U4VB/G0lT5rUlGdi1GZfSgjLmcjWt2X+i0lZ
        <span class="token assign-left variable">QAuojeKlOMRUnIb3h1U</span><span class="token operator">=</span>
        <span class="token punctuation">)</span> <span class="token punctuation">;</span> ZSK<span class="token punctuation">;</span> alg <span class="token operator">=</span> RSASHA1 <span class="token punctuation">;</span> key <span class="token function">id</span> <span class="token operator">=</span> <span class="token number">63462</span>

<span class="token number">5</span> ----<span class="token operator">&gt;</span> <span class="token number">30</span>
</code></pre><ul>
<li>结果:<br>
<img src="../resources/photos/iwbtfy_dnskey_error_distribute.png" alt=""></li>
<li>说明:
<ul>
<li>No DNSKEY is valid to check the RRSIG of the RRset：期望的正确返回</li>
<li>DIGcommand failed：无法连接到dns服务器</li>
<li>Impossible to verify the non-existence, the NSEC RRset can’t be validated：服务器探测不到域名的A地址时的返回，即当服务器发现域名的DNSSEC配置有问题后就不再进一步解析，也可算是一种检错的结果</li>
<li>DNSKEY is missing to continue validation：检测错误</li>
<li>RRSIG is missing to continue validation：检测错误</li>
<li>针对该配置错误类型，我们以No DNSKEY is valid to check the RRSIG of the RRset为主要判断依据。</li>
</ul>
</li>
</ul>
<ol start="3">
<li><strong>RRSIG missing</strong></li>
</ol>
<ul>
<li>配置: 直接注释掉A记录的RRSIG</li>
</ul>
<pre data-role="codeBlock" data-info="shell" class="language-shell shell"><code>       <span class="token number">600</span>	A	<span class="token number">123.207</span>.59.193
<span class="token punctuation">;</span>      <span class="token number">600</span>	RRSIG	A <span class="token number">5</span> <span class="token number">2</span> <span class="token number">600</span> <span class="token punctuation">(</span>
<span class="token punctuation">;</span>              <span class="token number">20240112145536</span> <span class="token number">20231213145536</span> <span class="token number">63462</span> iwbtfy.top.
<span class="token punctuation">;</span>              hdCiDnQ11MYeqRhx+PzKMFrFgsujDoD/PWSe
<span class="token punctuation">;</span>              hWR9KwawsoDabXWjmryhT5PzwpIsuVim09Qw
<span class="token punctuation">;</span>              <span class="token assign-left variable">BwYqeLtjCvguFQ</span><span class="token operator">==</span> <span class="token punctuation">)</span>
</code></pre><ul>
<li>结果:<br>
<img src="../resources/photos/iwbtfy_RRsigMissing_error_distribute.png" alt=""></li>
<li>说明:
<ul>
<li>RRSIG is missing to continue validation：期望的正确返回</li>
<li>DIGcommand failed：无法连接到dns服务器</li>
<li>Impossible to verify the non-existence, the NSEC RRset can’t be validated：服务器探测不到域名的A地址时的返回，即当服务器发现域名的DNSSEC配置有问题后就不再进一步解析，也可算是一种检错的结果</li>
<li>针对该配置错误类型，我们以RRSIG is missing to continue validation为主要判断依据。</li>
</ul>
</li>
</ul>
<ol start="4">
<li><strong>NSEC missing</strong></li>
</ol>
<ul>
<li>配置: 直接注释掉nsec</li>
</ul>
<pre data-role="codeBlock" data-info="shell" class="language-shell shell"><code><span class="token punctuation">;</span>			<span class="token number">21600</span>	NSEC	mail.iwbtfy.top. A NS SOA MX RRSIG NSEC DNSKEY
<span class="token punctuation">;</span>			<span class="token number">21600</span>	RRSIG	NSEC <span class="token number">5</span> <span class="token number">2</span> <span class="token number">21600</span> <span class="token punctuation">(</span>
<span class="token punctuation">;</span>					<span class="token number">20240112145536</span> <span class="token number">20231213145536</span> <span class="token number">63462</span> iwbtfy.top.
<span class="token punctuation">;</span>					HVTpaXHK2/gQXtj6MEaL0f1KntSWRSk2gHnl
<span class="token punctuation">;</span>					3F9cjYttR/jcLWYdJOshXBNjSWokpvF7auih
<span class="token punctuation">;</span>					<span class="token number">3</span>+li4ADLAIFMYw<span class="token operator">==</span> <span class="token punctuation">)</span>
</code></pre><ul>
<li>结果:<br>
<img src="../resources/photos/iwbtfy_nsec_error_distribute.png" alt=""></li>
<li>说明:
<ul>
<li>Impossible to verify the non-existence, the NSEC RRset can’t be validated：期望的正确返回</li>
<li>DIGcommand failed：无法连接到dns服务器</li>
<li>DNSKEY is missing to continue validation：检测错误</li>
<li>RRSIG is missing to continue validation：检测错误</li>
<li>针对该配置错误类型，我们以Impossible to verify the non-existence, the NSEC RRset can’t be validated为主要判断依据。</li>
</ul>
</li>
</ul>
<h3 id="32-wwwiwbtfytop上配置的错误">3.2 www.iwbtfy.top上配置的错误 </h3>
<ol>
<li><strong>DNSKEY missing</strong></li>
</ol>
<ul>
<li>配置: 直接注释掉DNSKEY</li>
</ul>
<pre data-role="codeBlock" data-info="shell" class="language-shell shell"><code><span class="token punctuation">;</span>      <span class="token number">600</span>	DNSKEY	<span class="token number">256</span> <span class="token number">3</span> <span class="token number">5</span> <span class="token punctuation">(</span>
<span class="token punctuation">;</span>             AwEAAZjFG/UFHijzwJ5d2TpLl7XYwKJodDpJ
<span class="token punctuation">;</span>             LrSxRAHMEqAd7O0t0NVtXRooQPO+RjgGIqmp
<span class="token punctuation">;</span>             <span class="token assign-left variable">D9BB3cpzhuqeQSLHI3k</span><span class="token operator">=</span>
<span class="token punctuation">;</span>             <span class="token punctuation">)</span> <span class="token punctuation">;</span> ZSK<span class="token punctuation">;</span> alg <span class="token operator">=</span> RSASHA1 <span class="token punctuation">;</span> key <span class="token function">id</span> <span class="token operator">=</span> <span class="token number">24216</span>
</code></pre><ul>
<li>
<p>结果:<br>
<img src="../resources/photos/www_DnskeyMissing_error_distribute.png" alt=""></p>
</li>
<li>
<p>说明:</p>
<ul>
<li>RRSIG is missing to continue validation：期望的正确返回</li>
<li>DIGcommand failed：无法连接到dns服务器</li>
<li>Impossible to verify the non-existence, the NSEC RRset can’t be validated：服务器探测不到域名的A地址时的返回，即当服务器发现域名的DNSSEC配置有问题后就不再进一步解析，也可算是一种检错的结果</li>
<li>Error no DS validates a DNSKEY in the DNSKEY RRset：检测错误</li>
<li>针对该配置错误类型，我们以RRSIG is missing to continue validation为主要判断依据。</li>
</ul>
</li>
</ul>
<ol start="2">
<li><strong>RRSIG missing</strong></li>
</ol>
<ul>
<li>配置: 直接注释掉RRSIG</li>
</ul>
<pre data-role="codeBlock" data-info="shell" class="language-shell shell"><code>         <span class="token number">600</span>	A	<span class="token number">123.207</span>.59.193
<span class="token punctuation">;</span>        <span class="token number">600</span>	RRSIG	A <span class="token number">5</span> <span class="token number">3</span> <span class="token number">600</span> <span class="token punctuation">(</span>
<span class="token punctuation">;</span>                <span class="token number">20240113102237</span> <span class="token number">20231214102237</span> <span class="token number">24216</span> www.iwbtfy.top.
<span class="token punctuation">;</span>                fHjWKPUHJdUhWZiZmQJyVG23gPZdEcNbhwe1
<span class="token punctuation">;</span>                ievRpFmRvUa9dAiCtTqeHXWhxy+U8i6EjSNM
<span class="token punctuation">;</span>                4Tv7HXZc/OKpPw<span class="token operator">==</span> <span class="token punctuation">)</span>
</code></pre><ul>
<li>
<p>结果:<br>
<img src="../resources/photos/www_RRsigMissing_error_distribute.png" alt=""></p>
</li>
<li>
<p>说明:</p>
<ul>
<li>RRSIG is missing to continue validation：期望的正确返回</li>
<li>DIGcommand failed：无法连接到dns服务器</li>
<li>Impossible to verify the non-existence, the NSEC RRset can’t be validated：服务器探测不到域名的A地址时的返回，即当服务器发现域名的DNSSEC配置有问题后就不再进一步解析，也可算是一种检错的结果</li>
<li>针对该配置错误类型，我们以RRSIG is missing to continue validation为主要判断依据。</li>
</ul>
</li>
</ul>
<ol start="3">
<li><strong>Signature Not Yet Valid</strong></li>
</ol>
<ul>
<li>配置: 将签名的起始时间改为比当前的时间晚</li>
</ul>
<pre data-role="codeBlock" data-info="shell" class="language-shell shell"><code><span class="token number">600</span>	DS	<span class="token number">19291</span> <span class="token number">5</span> <span class="token number">2</span> <span class="token punctuation">(</span>
        4B91D8C3CBD8F956D8CF35FF7E7369EE307C
        526F9A0F5C9B3BFA720158D98970 <span class="token punctuation">)</span>
<span class="token number">600</span>	RRSIG	DS <span class="token number">5</span> <span class="token number">3</span> <span class="token number">600</span> <span class="token punctuation">(</span>
        <span class="token number">20240112145536</span> <span class="token number">20231213145536</span> <span class="token number">63462</span> iwbtfy.top.
        BJyUMVBGzFZ1Xq3eCp7/FK4cwZUFq8gBBqt/
        cMQFSxGoz4XeQssiBysQlX33kzlR5TA4KYTT
        sntsqqDLxZJ/+Q<span class="token operator">==</span> <span class="token punctuation">)</span>

目前时间--<span class="token operator">&gt;</span><span class="token number">20231223234345</span>
结束有效时间--<span class="token operator">&gt;</span><span class="token number">20240112145536</span> 
开始有效时间--<span class="token operator">&gt;</span><span class="token number">20231213145536</span> 改成 <span class="token number">20231224432432</span>
</code></pre><ul>
<li>
<p>结果:<br>
<img src="../resources/photos/www_dsNotValid_error_distribute.png" alt=""></p>
</li>
<li>
<p>说明:</p>
<ul>
<li>RRSIG is missing to continue validation：期望的正确返回</li>
<li>DIGcommand failed：无法连接到dns服务器</li>
<li>Impossible to verify the non-existence, the NSEC RRset can’t be validated：服务器探测不到域名的A地址时的返回，即当服务器发现域名的DNSSEC配置有问题后就不再进一步解析，也可算是一种检错的结果</li>
<li>DNSKEY is missing to continue validation：检测错误</li>
<li>No DNSKEY is valid to check the RRSIG of the RRset：检测错误</li>
<li>针对该配置错误类型，我们以RRSIG is missing to continue validation为主要判断依据。</li>
</ul>
</li>
</ul>
<ol start="4">
<li><strong>Signature Expired</strong></li>
</ol>
<ul>
<li>配置: 将签名的结束时间改成比当前的早</li>
</ul>
<pre data-role="codeBlock" data-info="shell" class="language-shell shell"><code><span class="token number">600</span>	DS	<span class="token number">19291</span> <span class="token number">5</span> <span class="token number">2</span> <span class="token punctuation">(</span>
        4B91D8C3CBD8F956D8CF35FF7E7369EE307C
        526F9A0F5C9B3BFA720158D98970 <span class="token punctuation">)</span>
<span class="token number">600</span>	RRSIG	DS <span class="token number">5</span> <span class="token number">3</span> <span class="token number">600</span> <span class="token punctuation">(</span>
        <span class="token number">20240112145536</span> <span class="token number">20231213145536</span> <span class="token number">63462</span> iwbtfy.top.
        BJyUMVBGzFZ1Xq3eCp7/FK4cwZUFq8gBBqt/
        cMQFSxGoz4XeQssiBysQlX33kzlR5TA4KYTT
        sntsqqDLxZJ/+Q<span class="token operator">==</span> <span class="token punctuation">)</span>
        
目前时间--<span class="token operator">&gt;</span><span class="token number">20231223234345</span>
结束有效时间--<span class="token operator">&gt;</span><span class="token number">20240112145536</span> 改成 <span class="token number">20231222432432</span>
开始有效时间--<span class="token operator">&gt;</span><span class="token number">20231213145536</span> 
</code></pre><ul>
<li>
<p>结果:<br>
<img src="../resources/photos/www_dsExpiration_error_distribute.png" alt=""></p>
</li>
<li>
<p>说明:</p>
<ul>
<li>Impossible to verify the non-existence, the NSEC RRset can’t be validated：期望的正确返回</li>
<li>DIGcommand failed：无法连接到dns服务器</li>
<li>DNSKEY is missing to continue validation：检测错误</li>
<li>RRSIG is missing to continue validation：检测错误</li>
<li>针对该配置错误类型，我们以Impossible to verify the non-existence, the NSEC RRset can’t be validated为主要判断依据。</li>
</ul>
</li>
</ul>
<ol start="5">
<li><strong>Unsupported DS Digest Type</strong></li>
</ol>
<ul>
<li>配置: 将ds记录的摘要类型改成支持范围外</li>
</ul>
<pre data-role="codeBlock" data-info="shell" class="language-shell shell"><code><span class="token number">600</span>	DS	<span class="token number">19291</span> <span class="token number">5</span> <span class="token number">2</span> <span class="token punctuation">(</span>
        4B91D8C3CBD8F956D8CF35FF7E7369EE307C
        526F9A0F5C9B3BFA720158D98970 <span class="token punctuation">)</span>

<span class="token number">5</span> ---<span class="token operator">&gt;</span> <span class="token number">50</span>
</code></pre><ul>
<li>
<p>结果:<br>
<img src="../resources/photos/www_unSupportedDsType_error_distribute.png" alt=""></p>
</li>
<li>
<p>说明:</p>
<ul>
<li>Error no DS validates a DNSKEY in the DNSKEY RRset：期望的正确返回</li>
<li>DIGcommand failed：无法连接到dns服务器</li>
<li>Impossible to verify the non-existence, the NSEC RRset can’t be validated：服务器探测不到域名的A地址时的返回，即当服务器发现域名的DNSSEC配置有问题后就不再进一步解析，也可算是一种检错的结果</li>
<li>DNSKEY is missing to continue validation：检测错误</li>
<li>RRSIG is missing for continue validation：检测错误</li>
<li>RRSIG for DNSKEY is missing to continue validation：检测错误</li>
<li>the DNSKEY isn't trusted-key and there isn't DS to validate the DNSKEY：检测错误</li>
<li>针对该配置错误类型，我们以Error no DS validates a DNSKEY in the DNSKEY RRset为主要判断依据。</li>
</ul>
</li>
</ul>
<ol start="6">
<li><strong>DNSKEY Signature expired</strong></li>
</ol>
<ul>
<li>配置: 修改dnskey的签名时间比当前早</li>
</ul>
<pre data-role="codeBlock" data-info="shell" class="language-shell shell"><code><span class="token number">600</span>	RRSIG	DNSKEY <span class="token number">5</span> <span class="token number">3</span> <span class="token number">600</span> <span class="token punctuation">(</span>
        <span class="token number">20240113102237</span> <span class="token number">20231214102237</span> <span class="token number">19291</span> www.iwbtfy.top.
        dbcIJCaP6qFlpf5rc7tB76qE0ijYEPd8T+8k
        Yt6vj+ZzyvMdPcqHlOAt8GPOMtuf4x1swmD7
        ZanW8Y/Sc1Rojg<span class="token operator">==</span> <span class="token punctuation">)</span>

目前时间--<span class="token operator">&gt;</span><span class="token number">20231223234345</span>
结束有效时间--<span class="token operator">&gt;</span><span class="token number">20240113102237</span> 改成 <span class="token number">20231222432432</span>
开始有效时间--<span class="token operator">&gt;</span><span class="token number">20231214102237</span>
</code></pre><ul>
<li>结果:</li>
</ul>
<p><img src="../resources/photos/www_dnskeySigExpired_error_distribute.png" alt=""></p>
<ul>
<li>
<p>说明:</p>
<ul>
<li>RRSIG is missing for continue validation：期望的正确返回</li>
<li>DIGcommand failed：无法连接到dns服务器</li>
<li>Impossible to verify the non-existence, the NSEC RRset can’t be validated：服务器探测不到域名的A地址时的返回，即当服务器发现域名的DNSSEC配置有问题后就不再进一步解析，也可算是一种检错的结果</li>
<li>DNSKEY is missing to continue validation：检测错误</li>
<li>No DNSKEY is valid to check the RRSIG of the RRset：检测错误</li>
<li>针对该配置错误类型，我们以RRSIG is missing for continue validation为主要判断依据。</li>
</ul>
</li>
</ul>
<h2 id="4未来推进方向探究">4.未来推进方向探究 </h2>
<p>在于陈老师开会讨论后，陈老师提出了新的思路，即通过修改dig版本，使其支持edns，将其他返回的错误文本信息都统一转换为error_code，如下图，以更好的说明服务器的检测能力。同时，为了搭建一个整体的检测系统，我们后续将为每一种错误类型申请一个三级域名并配置错误，最后再封装成递归解析安全增强措施部署分析的原型系统。<br>
<img src="./photos/ecode.png" alt=""></p>

      </div>
      
      
    
    
    
    
    
    
  
    </body></html>